---
description: USE WHEN designing, implementing, or reviewing data protection (classification, encryption, key management, privacy)
alwaysApply: false
---
# Data Protection & Privacy

These rules apply throughout the application and aimed at maintaining data security and privacy throughout the application.

## Data Classification

- Classify data based on sensitivity
- Apply appropriate controls based on classification
- Document data flows and storage locations
- Implement data minimization principles

## Encryption

### Data in Transit

- Use TLS 1.2+ for all connections
- Configure secure TLS settings
- Enforce HTTPS through HSTS
- Apply proper certificate management
- Validate certificates

### Data at Rest

- Encrypt sensitive data before storage
- Use strong encryption algorithms (AES-256, ChaCha20)
- Implement proper key management
- Consider using envelope encryption
- Rotate encryption keys periodically

## Key Management

- Securely store encryption keys
- Separate keys from encrypted data
- Implement key rotation procedures
- Use a key management service when possible
- Apply the principle of least privilege to key access

## Data Minimization & Privacy

- Collect only necessary data
- Implement data retention policies
- Provide mechanisms for data export and deletion
- Implement consent management
- Apply privacy by design principles

## Anti-Patterns to Avoid

- Storing sensitive data in plaintext
- Hardcoding encryption keys or secrets
- Implementing custom encryption algorithms
- Failing to validate certificates
- Storing sensitive data in logs or error messages
